tinymce.PluginManager.add("tabfocus",function(e){function t(e){9===e.keyCode&&e.preventDefault()}function n(t){function n(t){function n(e){return"BODY"===e.nodeName||"hidden"!=e.type&&"none"!=e.style.display&&"hidden"!=e.style.visibility&&n(e.parentNode)}function s(e){return e.tabIndex||"INPUT"==e.nodeName||"TEXTAREA"==e.nodeName}function f(e){return!s(e)&&"-1"!=e.getAttribute("tabindex")&&n(e)}if(a=r.select(":input:enabled,*[tabindex]:not(iframe)"),i(a,function(t,n){return t.id==e.id?(u=n,!1):void 0}),t>0){for(l=u+1;l<a.length;l++)if(f(a[l]))return a[l]}else for(l=u-1;l>=0;l--)if(f(a[l]))return a[l];return null}var u,a,f,l;if(9===t.keyCode&&(f=s(e.getParam("tab_focus",e.getParam("tabfocus_elements",":prev,:next"))),1==f.length&&(f[1]=f[0],f[0]=":prev"),a=t.shiftKey?":prev"==f[0]?n(-1):r.get(f[0]):":next"==f[1]?n(1):r.get(f[1]))){var c=tinymce.get(a.id||a.name);a.id&&c?c.focus():window.setTimeout(function(){tinymce.Env.webkit||window.focus(),a.focus()},10),t.preventDefault()}}var r=tinymce.DOM,i=tinymce.each,s=tinymce.explode;e.on("init",function(){e.inline&&tinymce.DOM.setAttrib(e.getBody(),"tabIndex",null)}),e.on("keyup",t),tinymce.Env.gecko?e.on("keypress keydown",n):e.on("keydown",n)});