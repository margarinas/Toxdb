!function(e,t){function n(e,t){for(var n,r=[],i=0;i<e.length;++i){if(n=u[e[i]]||s(e[i]),!n)throw"module definition dependecy not found: "+e[i];r.push(n)}t.apply(null,r)}function r(e,r,i){if("string"!=typeof e)throw"invalid module definition, module id must be defined and be a string";if(r===t)throw"invalid module definition, dependencies must be specified";if(i===t)throw"invalid module definition, definition function must be specified";n(r,function(){u[e]=i.apply(null,arguments)})}function i(e){return!!u[e]}function s(t){for(var n=e,r=t.split(/[.\/]/),i=0;i<r.length;++i){if(!n[r[i]])return;n=n[r[i]]}return n}function o(n){for(var r=0;r<n.length;r++){for(var i=e,s=n[r],o=s.split(/[.\/]/),a=0;a<o.length-1;++a)i[o[a]]===t&&(i[o[a]]={}),i=i[o[a]];i[o[o.length-1]]=u[s]}}var u={},a="tinymce/spellcheckerplugin/DomTextMatcher",f="tinymce/spellcheckerplugin/Plugin",l="tinymce/PluginManager",c="tinymce/util/Tools",h="tinymce/ui/Menu",p="tinymce/dom/DOMUtils",d="tinymce/util/JSONRequest",v="tinymce/util/URI";r(a,[],function(){return function(e,t,n){function r(e){if(!e[0])throw"findAndReplaceDOMText cannot handle zero-length matches";var t=e.index;return[t,t+e[0].length,[e[0]]]}function i(e){var t;if(3===e.nodeType)return e.data;if(m[e.nodeName])return"";if(t="",(v[e.nodeName]||g[e.nodeName])&&(t+="\n"),e=e.firstChild)do t+=i(e);while(e=e.nextSibling);return t}function s(e,t,n){var r,i,s,o,u=[],a=0,f=e,l=t.shift(),c=0;e:for(;;){if((v[f.nodeName]||g[f.nodeName])&&a++,3===f.nodeType&&(!i&&f.length+a>=l[1]?(i=f,o=l[1]-a):r&&u.push(f),!r&&f.length+a>l[0]&&(r=f,s=l[0]-a),a+=f.length),r&&i){if(f=n({startNode:r,startNodeIndex:s,endNode:i,endNodeIndex:o,innerNodes:u,match:l[2],matchIndex:c}),a-=i.length-o,r=null,i=null,u=[],l=t.shift(),c++,!l)break}else{if(!m[f.nodeName]&&f.firstChild){f=f.firstChild;continue}if(f.nextSibling){f=f.nextSibling;continue}}for(;;){if(f.nextSibling){f=f.nextSibling;break}if(f.parentNode===e)break e;f=f.parentNode}}}function o(e){var t;if("function"!=typeof e){var n=e.nodeType?e:d.createElement(e);t=function(e,t){var r=n.cloneNode(!1);return r.setAttribute("data-mce-index",t),e&&r.appendChild(d.createTextNode(e)),r}}else t=e;return function r(e){var n,r,i,s=e.startNode,o=e.endNode,u=e.matchIndex;if(s===o){var a=s;i=a.parentNode,e.startNodeIndex>0&&(n=d.createTextNode(a.data.substring(0,e.startNodeIndex)),i.insertBefore(n,a));var f=t(e.match[0],u);return i.insertBefore(f,a),e.endNodeIndex<a.length&&(r=d.createTextNode(a.data.substring(e.endNodeIndex)),i.insertBefore(r,a)),a.parentNode.removeChild(a),f}n=d.createTextNode(s.data.substring(0,e.startNodeIndex)),r=d.createTextNode(o.data.substring(e.endNodeIndex));for(var l=t(s.data.substring(e.startNodeIndex),u),c=[],h=0,p=e.innerNodes.length;p>h;++h){var v=e.innerNodes[h],m=t(v.data,u);v.parentNode.replaceChild(m,v),c.push(m)}var g=t(o.data.substring(0,e.endNodeIndex),u);return i=s.parentNode,i.insertBefore(n,s),i.insertBefore(l,s),i.removeChild(s),i=o.parentNode,i.insertBefore(g,o),i.insertBefore(r,o),i.removeChild(o),g}}function u(e){var t=[];return a(function(n,r){e(n,r)&&t.push(n)}),c=t,this}function a(e){for(var t=0,n=c.length;n>t&&e(c[t],t)!==!1;t++);return this}function f(e){return c.length&&(p=c.length,s(t,c,o(e))),this}var l,c=[],h,p=0,d,v,m,g;if(d=t.ownerDocument,v=n.getBlockElements(),m=n.getWhiteSpaceElements(),g=n.getShortEndedElements(),h=i(t),h&&e.global)for(;l=e.exec(h);)c.push(r(l));return{text:h,count:p,matches:c,each:a,filter:u,mark:f}}}),r(f,[a,l,c,h,p,d,v],function(e,t,n,r,i,s,o){t.add("spellchecker",function(t,u){function a(e){for(var t in e)return!1;return!0}function f(e,s){var o=[],u=m[s];n.each(u,function(e){o.push({text:e,onclick:function(){t.insertContent(e),c()}})}),o.push.apply(o,[{text:"-"},{text:"Ignore",onclick:function(){p(e,s)}},{text:"Ignore all",onclick:function(){p(e,s,!0)}},{text:"Finish",onclick:d}]),y=new r({items:o,context:"contextmenu",onautohide:function(e){-1!=e.target.className.indexOf("spellchecker")&&e.preventDefault()},onhide:function(){y.remove(),y=null}}),y.renderTo(document.body);var a=i.DOM.getPos(t.getContentAreaContainer()),f=t.dom.getPos(e);a.x+=f.x,a.y+=f.y,y.moveTo(a.x,a.y+e.offsetHeight)}function l(){function n(e){return t.setProgressState(!1),a(e)?(t.windowManager.alert("No misspellings found"),g=!1,void 0):(m=e,i.filter(function(t){return!!e[t[2][0]]}).mark(t.dom.create("span",{"class":"mce-spellchecker-word","data-mce-bogus":1})),i=null,t.fire("SpellcheckStart"),void 0)}function r(e,n,r){s.sendRPC({url:(new o(u)).toAbsolute(b.spellchecker_rpc_url),method:e,params:{lang:b.spellchecker_language||"en",words:n},success:function(e){r(e)},error:function(e,n){e="JSON Parse error."==e?"Non JSON response:"+n.responseText:"Error: "+e,t.windowManager.alert(e),t.setProgressState(!1),i=null,g=!1}})}var i,f=[],l={};if(g)return d(),void 0;g=!0;var c=t.getParam("spellchecker_wordchar_pattern")||new RegExp('[^\\s!"#$%&()*+,-./:;<=>?@[\\]^_{|}`§©«®±¶·¸»¼½¾¿×÷¤”“„]+',"g");i=(new e(c,t.getBody(),t.schema)).each(function(e){var t=e[2][0];if(!l[t]){if(/^\d+$/.test(t)||1==t.length)return;f.push(t),l[t]=!0}}),t.setProgressState(!0);var h=b.spellchecker_callback||r;h("spellcheck",f,n)}function c(){t.dom.select("span.mce-spellchecker-word").length||d()}function h(e){var t=e.parentNode;t.insertBefore(e.firstChild,e),e.parentNode.removeChild(e)}function p(e,r,i){i?n.each(t.dom.select("span.mce-spellchecker-word"),function(e){var t=e.innerText||e.textContent;t==r&&h(e)}):h(e),c()}function d(){var e,n,r;for(g=!1,r=t.getBody(),n=r.getElementsByTagName("span"),e=n.length;e--;)r=n[e],r.getAttribute("data-mce-index")&&h(r);t.fire("SpellcheckEnd")}function v(e){var n,r,i,s=-1,o,u;for(e=""+e,n=t.getBody().getElementsByTagName("span"),r=0;r<n.length&&(i=n[r],"mce-spellchecker-word"!=i.className||(s=i.getAttribute("data-mce-index"),s===e&&(s=e,o||(o=i.firstChild),u=i.firstChild),s===e||!u));r++);var a=t.dom.createRng();return a.setStart(o,0),a.setEnd(u,u.length),t.selection.setRng(a),a}var m,g,y,b=t.settings;t.on("click",function(e){if("mce-spellchecker-word"==e.target.className){e.preventDefault();var t=v(e.target.getAttribute("data-mce-index"));f(e.target,t.toString())}}),t.addMenuItem("spellchecker",{text:"Spellcheck",context:"tools",onclick:l,selectable:!0,onPostRender:function(){var e=this;t.on("SpellcheckStart SpellcheckEnd",function(){e.active(g)})}}),t.addButton("spellchecker",{tooltip:"Spellcheck",onclick:l,onPostRender:function(){var e=this;t.on("SpellcheckStart SpellcheckEnd",function(){e.active(g)})}}),t.on("remove",function(){y&&(y.remove(),y=null)})})}),o([a,f])}(this);