define(["utils/poisonAutocomplete","app/substance/add","app/agent/add","utils/pagination","app/substance/search","utils/tableRow"],function(e,t,n,r,i,s){return init=function(o){if(typeof o!="object"&&typeof o!="undefined")throw new Error("Must provide options as an object");defaults={container:"#container",rowLimit:25,history:!0,attachTo:null,searchCallback:function(){},rowClickCallback:function(){}};var u=$.extend(defaults,o);e.init("#SubstanceTerm"),$("#search_db").click(function(e){$("#toxinz_term").val($("#SubstanceTerm").val()),$("#toxinz_form").submit(),window.open("http://www.toxbase.org/Basic-search/?quicksearchquery="+$("#SubstanceTerm").val(),"_blank")}),$("#SubstanceSearchForm").submit(function(e){console.log(u.container),$(u.container).html('<div class="row-fluid"><div class="span6"><h4>Produktai</h4><div id="substances"></div></div><div class="span6"><h4>Med≈æiagos</h4><div id="agents"></div></div></div>'),s.init(".agent_row",u.container,u.rowClickCallback),s.init(".substance_row",u.container,u.rowClickCallback),data=$(this).serialize(),query={limit:u.rowLimit,attachTo:u.attachTo},data=data+"&"+$.param(query),url=$(this).attr("action")+"?"+data,i.init(data,function(){u.searchCallback(),r.init({element:".pagination",container:"#substances",history:u.history,limit:u.rowLimit,callback:u.searchCallback}),r.init({element:".pagination",container:"#agents",history:u.history,limit:u.rowLimit,callback:u.searchCallback})}),u.history&&history.pushState(null,null,url),e.preventDefault()}),$("#add-new-substance").click(function(e){url=e.target.href,$("#busy-indicator").fadeIn(),$(u.container).load(url,$.param({attachTo:u.attachTo}),function(){t.init({container:u.container,redirectTo:"dashboard"}),$("#busy-indicator").fadeOut(),u.history&&history.pushState(null,null,url)}),e.preventDefault()}),$("#add-new-agent").click(function(e){url=e.target.href,$("#busy-indicator").fadeIn(),$(u.container).load(url,$.param({attachTo:u.attachTo}),function(){n.init({container:u.container,redirectTo:"dashboard"}),$("#busy-indicator").fadeOut(),u.history&&history.pushState(null,null,url)}),e.preventDefault()})},{init:init}});