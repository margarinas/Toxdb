define(["utils/tableRow","utils/pagination","utils/getElement","utils/autocomplete","utils/poisonAutocomplete","utils/message"],function(e,t,n,r,i,s){function u(n){defaults={container:"#container",rowCallback:null,hideControls:!1,search:!0,callback:null,showPaginatorSummary:!0,limit:20},o=$.extend(defaults,n),e.init(".event_row",o.container,function(){typeof o.rowCallback=="function"&&o.rowCallback()}),o.hideControls===!0&&$(o.container+" .control-hide").hide(),o.container==="#container"?showHistory=!0:showHistory=!1,console.log(typeof o.callback),typeof o.callback=="function"?(firstCallback=o.callback,o.callback=function(){firstCallback(),eventSearch()}):o.search&&(o.callback=eventSearch),t.init({container:o.container,history:showHistory,callback:o.callback,showSummary:o.showPaginatorSummary,limit:o.limit}),$(".datepicker").datepicker(),r.init(),i.init("#poison_autocomplete"),events_selected=!1,$(".event-select-all").click(function(e){events_selected?($(".event_row").removeClass("success").find(".select_event").prop("checked",""),events_selected=!1):($(".event_row").addClass("success").find(".select_event").prop("checked","checked"),events_selected=!0),e.preventDefault()}),$(o.container).on("click",".event-delete",function(e){var t=$(this).parents("tr.event_row");return confirm("Ar tikrai norite i≈°trinti ?")&&$.post($(this).attr("href"),function(e){console.log(e),e.result==="success"&&t.fadeOut(function(){$(this).remove()}),s.init(e.message)}),e.preventDefault(),!1}),typeof o.callback=="function"&&o.callback()}var o;return eventSearch=function(){$(".clear-search").click(function(){$("#EventFindForm input").val("").prop("checked",!1),$("#EventFindForm select").each(function(){$(this)[0].selectedIndex=0})}),$("#EventFindForm").submit(function(e){url=$(this).attr("action"),data=$(this).serialize(),$.ajax({method:"post",beforeSend:function(e){$("#busy-indicator").fadeIn()},complete:function(e,t){$("#busy-indicator").fadeOut()},success:function(e,t,n){$(o.container).html(e),u(o),o.container==="#container"&&history.pushState(null,null,$(e).find("#EventCurrentUrl").val())},data:data,url:url}),e.preventDefault()})},{init:u,search:eventSearch}});