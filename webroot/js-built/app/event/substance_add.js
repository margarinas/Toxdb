define(["jquery","utils/modal","utils/getElement","app/substance/actions"],function(e,t,n,r){var i={show:!0,id:"add_substance",title:"Ieškoti nuodingosios medžiagos",footer:'<button class="btn" data-dismiss="modal" aria-hidden="true">Close</button><button class="btn btn-primary disabled attach_substance">Priskirti medžiagą pacientui</button> ',onHide:function(){e(".modal .substance-actions").remove();var t=e(".formated_substances").length;t>0&&e(".agent-main-group").remove(),t==1&&e(".formated_substances input:radio").prop("checked",!0),e(".agent_fields").each(function(t,n){e(n).find("input:not(:checkbox), select").incrementInput({num:t,separator:"%"})}),e("input.agent_dose_field").keyup(function(t){var n=e(this).siblings(".agent_toxic_dose").val(),r=e(this).siblings("select.agent_dose_field").val(),i=e(this).val(),s=e("#Patient0Weight").val();r=="mg/kg"})}},s;n.loadElement({name:"substance/actions"},function(e){s=e}),e(".add_substance").click(function(n){e(this).hasClass("add-event-substance")?attachTo="Event":attachTo="Patient.0",t.set(i,function(){e(".modal-header").after(e(s).addClass("margin10")),r.init({container:".modal-body",rowLimit:7,history:!1,attachTo:attachTo,searchCallback:function(){e(".modal-body .actions").hide()},rowClickCallback:function(){e(".attach_substance").removeClass("disabled")}}),e(".attach_substance").click(function(t){e(this).hasClass("disabled")||(e(".substances").append(e(".select_substance:checked").next().find("input:checkbox").prop("checked","checked").parents(".formated_substances").removeClass("hide")),e("#container .agents").append(e(".select_substance:checked").siblings(".agent_fields").find("input:checkbox").prop("checked","checked").end().show()),e("#container .agents").append(e(".select_agent:checked").next().find("input:checkbox").prop("checked","checked").parents(".agent_fields").show()),e(".attach_substance").addClass("disabled"),e("#add_substance").modal("hide"))})}),n.preventDefault()})});